"use strict";const t=require("electron"),n=require("node:path"),i=require("node:fs"),c=require("node:process"),p=require("node:url");var a=typeof document<"u"?document.currentScript:null;const d=!!c.env.VITE_DEV_SERVER_URL,u=p.fileURLToPath(typeof document>"u"?require("url").pathToFileURL(__filename).href:a&&a.tagName.toUpperCase()==="SCRIPT"&&a.src||new URL("main.js",document.baseURI).href),r=n.dirname(u),f=t.app.getPath("userData"),s=n.join(f,"appData.json");function h(){try{if(i.existsSync(s)){const e=i.readFileSync(s,"utf-8");return JSON.parse(e)}}catch(e){console.error("Failed to read data file:",e)}return{}}function w(e){try{i.writeFileSync(s,JSON.stringify(e,null,2),"utf-8")}catch(o){console.error("Failed to write data file:",o)}}const l=()=>{const e=new t.BrowserWindow({width:1280,height:800,minWidth:940,minHeight:600,icon:n.join(r,d?"../../public/logo.png":"../dist/logo.png"),webPreferences:{preload:n.join(r,"preload.js"),contextIsolation:!0,nodeIntegration:!1},show:!1});d?(e.loadURL(c.env.VITE_DEV_SERVER_URL),e.webContents.openDevTools()):e.loadFile(n.join(r,"../dist/index.html")),e.once("ready-to-show",()=>{e.show()})};t.app.whenReady().then(()=>{t.ipcMain.handle("get-data",()=>h()),t.ipcMain.handle("save-data",(e,o)=>{w(o)}),l(),t.app.on("activate",()=>{t.BrowserWindow.getAllWindows().length===0&&l()})});t.app.on("window-all-closed",()=>{c.platform!=="darwin"&&t.app.quit()});
